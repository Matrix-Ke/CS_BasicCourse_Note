#! https://zhuanlan.zhihu.com/p/571501790
# 欧拉方法的绝对稳定和刚性问题分析

在学习物理模拟过程中，使用欧拉方法[求解常微分方程](https://zhuanlan.zhihu.com/p/568552092)取定一个步长会得到一个错误的结果，遇到数值爆炸，不稳定的情况。 数值稳定性分析就尤为重要，因为有了稳定定性分析才可以评价一个数值方法的好坏。
### 1. 绝对稳定
绝对稳定也叫A稳定。对固定步长 $\mathrm{h}$ 和复数 $\lambda$, 应用数值方法
$$
y_{j+1}=y_j+h * \varphi\left(y_j, y_{j+1}, h\right)\\
$$
到模型问题：（$\lambda$实部小于0）
$$
y^{\prime}=\lambda y \\
$$
求解, 若得到的数值解 $y_j$ 一致有界, 即
$$
\left|y_j\right|<\text { const }, j=1,2, \ldots\\
$$
则称该数值方法对**一组数 $h \& \lambda$** 是绝对稳定的 (A-stable); 满足格式绝对稳定条件的 $h \lambda$ 所在复平面的一个区域称为：稳定性区域.

#### 1.1 模型问题为何只考虑线性问题
首先需要明白一点：任何数值分析方法，它的应用目标都是非线性问题（因此对于线性问题，可以直接得到解析解）。 之所以可以采用线性问题去分析非线性问题，是所有的非线性问题可以线性化。
针对非线性问题可采用局部线性化方法: （一阶泰勒展开，高阶丢掉）
$$
\begin{aligned}
y^{\prime} &=f(x, y)=f(\bar{x}, \bar{y})+f_x(\bar{x}, \bar{y}) \cdot(x-\bar{x})+f_y(\bar{x}, \bar{y}) \cdot(y-\bar{y})+\ldots \\
& \approx A y+B x+C
\end{aligned}
$$
线性映射简化问题，记(待定系数法确定y和z的关系):
$$
z=y+D x+E=y+\frac{B}{A} x+\frac{C+B / A}{A}
$$
得到模型问题形式:
$$
z^{\prime}=A z
$$

#### 1.2 为何可以取复数
单步法可以求解单个常微分方程，可以用于求解常微分方程组。一旦出现了方程组，那么他对应的就是一个矩阵，矩阵求解过程会存在复的特征值。
若考查的是非线性方程组
$$
\left\{\begin{array}{l}
y_1^{\prime}=f_1\left(x, y_1, y_2, \ldots, y_n\right) \\
y_2^{\prime}=f_2\left(x, y_1, y_2, \ldots, y_n\right) \\
\cdots \\
y_n^{\prime}=f_n\left(x, y_1, y_2, \ldots, y_n\right)
\end{array} \quad Y^{\prime}=F(Y)\right. \\
$$
同样可以考虑线性化, 得到如下形式的线性方程组
$$
\frac{d}{d x} Y=A Y  \qquad 其中  Y 为向量值函数, A=\left(a_{i j}\right)_{n \times n}\\
$$
设矩阵 $\mathrm{A}$ 可对角化为 $A=S \Lambda S^{-1}$, 即
$$
\frac{d}{d x}\left(S^{-1} Y\right)=\Lambda\left(S^{-1} Y\right), \quad \frac{d}{d x} Z=\Lambda Z
$$
实矩阵的特征值可能为复数(complex number), 因此需要考虑复数情况。

### Euler⽅法的稳定性区域

将Euler方法应用到模型问题得到：
$$
y_{j+1}=y_j+h \lambda y_j=(1+h \lambda) y_j=(1+\mu)^{j+1} y_0
$$
若要绝对问题得到等价条件：
$$
|1+h \lambda|=|1+\mu| \leq 1
$$
该条件对应图像: $\mu=h \lambda$ 为变量的复平面单位圆。若 $\lambda<0$ 取实数, 则
$$
-1<1+h \lambda<1, \quad h \leq -2 / \lambda\\
$$

* 发现向前Euler对步长h有要求，后退Euler对步长⽆要求（精度需求除外）


#### 2.1 刚性(stiff)问题
考虑如下线性微分方程组:
$$
\left\{\begin{array}{l}
y_1^{\prime}=-10 y_2 \\
y_2^{\prime}=100 y_1-1001 y_2
\end{array} \quad\left[\begin{array}{l}
y_1^{\prime} \\
y_2^{\prime}
\end{array}\right]=\left[\begin{array}{cc}
0 & -10 \\
100 & -1001
\end{array}\right]\left[\begin{array}{l}
y_1 \\
y_2
\end{array}\right] \rightarrow \frac{d}{d x} Y=A * Y\right. \\
$$
初值取
$$
y_1(0)=y_2(0)=1, \text { OR } \quad Y(0)=[1 ; 1]\\
$$
计算得到矩阵的特征对 $A S=S \Lambda$
$$
\left[\begin{array}{cc}
0 & -10 \\
100 & -1001
\end{array}\right] *\left[\begin{array}{cc}
10 & 1 \\
1 & 100
\end{array}\right]=\left[\begin{array}{cc}
10 & 1 \\
1 & 100
\end{array}\right]\left[\begin{array}{cc}
-1 & 0 \\
0 & -1000
\end{array}\right]
$$
记 $Z(x)=S^{-1} * Y(x)$ 得到
$$
\frac{d}{d x} Y=S \Lambda S^{-1} Y \rightarrow \frac{d}{d x} Z=\Lambda Z \rightarrow Z(x)=\left[\begin{array}{c}
c_1 e^{-x} \\
c_2 e^{-1000 x}
\end{array}\right]
$$
根据初值条件 $Z(0)=S^{-1} * Y(0)$ 确定常数 $c_1=11 / 111, c_2=1 / 111$ 进而得到精确解:
$$
Y(x)=S * Z(x)=\left[\begin{array}{l}
y_1(x) \\
y_2(x)
\end{array}\right]=\left[\begin{array}{l}
\frac{110}{111} e^{-x}+\frac{1}{111} e^{-1000 x} \\
\frac{11}{111} e^{-x}+\frac{100}{111} e^{-1000 x} \\
\end{array}\right]\\
$$
从矩阵解析解中可以知道 $\frac{110}{111}e^{-x}, \frac{1}{111} e^{-1000 x}$  两项数值差距过大, 由上面推导的绝对稳定性分析，发现刚性比（$h \le \frac{-2}{\lambda} \le -2 / (-1001)$ 与 $h \le \frac{-2}{\lambda} \le -2 / (-10)$）差距过大。  
>Note: 
> * 单个方程不存在刚性问题。在线性系统求解中，需要兼顾小的误差，导致计算上的浪费。
>* 所有显格式均不是A稳定的，不适合求解刚性问题。 刚性⽐越⼤，⽅程越病态，最好采⽤
A-stable⽅法，例如后退Euler，梯形⽅法。


### 参考资料
1. [【数值分析 中科大】](https://www.bilibili.com/video/BV1T4411D7x5?share_source=copy_web&vd_source=e84f3d79efba7dc72e6306f35613222e)
2. [【数值分析9(绝对稳定和刚性问题)数值分析】](https://www.bilibili.com/video/BV1gQ4y1P7p6?share_source=copy_web&vd_source=e84f3d79efba7dc72e6306f35613222e)