#! https://zhuanlan.zhihu.com/p/560191727
# 微分方程

最近在学习物理模拟过程中，经常遇到求解非线性微分方程的问题，于是准备系统的将微分方程整理一下。。。

### 微分方程分类：
* 常微分方程：末知函数为单变量 (一元) 函数
* 偏微分方程： 末知函数为多变量（二元或以上）函数。

数学工具： 研究变量 $x$ (自变量, 可以代表位置、时间等; 可以 是向量）和 $y$ (因变量, 可以代表温度、宓度等; 也可以是向量）之 间形如下这样的函数约束关系。
$$
F(x, y)=0\\
$$

很多时候 $x$ 和 $y$ 的关系还涉及末知函数的一次或多次导数（微分）， 即
$$
F\left(x, y, y^{\prime}, \ldots, y^{(n)}\right)=0 \\
$$

### 齐次方程形式 :
齐次形式：
$$
\frac{\mathrm{d} y}{\mathrm{~d} x}=\varphi\left(\frac{y}{x}\right)\\
$$
#### 齐次含义
**引入齐次函数概念：** 符合下面性质的函数，叫做次产次。这是齐次的根本来源。
$$
f(a x)=a^k f(x) \\
$$


**从函数到方程：** 当让函数去等于一个数 (最简单的 $f(x)=0)$ ，就完成了从函数到方程的构建。
eg： 令函数等于方程有： 
$$
f(x, y)=\frac{d y}{d x}-\varphi\left(\frac{y}{x}\right) \\
$$
得到如下的表达式，可知    函数是一个0次齐次函数。
$$
f(a x, a y)=\frac{d(a y)}{d(a x)}-\varphi\left(\frac{a y}{a x}\right)=a^0\left(\frac{d y}{d x}-\varphi\left(\frac{y}{x}\right)\right)=\frac{d y}{d x}-\varphi\left(\frac{y}{x}\right)\\
$$

#### 总结
* 本质上说， “次”代表函数中每一个独立项的指数， “齐”是指一样。 ”齐次“ 即表示函数每一个独立项的指数是相等的。
* 关于项的指数，要看所有的指数和。如 $x y$ ，对于 $\mathrm{x}$ 和  $\mathrm{y}$ 都是一次，但是二者相乘，指数相加，为 2 。 所以 $x y, x^2, y^2$ 是同指数，也就是同次的，是 "齐" "次" 的，是齐次的。

>Note: 
>* 对于微分方程，求解的对象将不再是变量 $x, y$ ，而是方程$f(y)$。 所以齐次的考量不再是 $f(x, y)$ ，而变成了 $f(y)$



**齐次线性方程:**
$$
\frac{\mathrm{d} y}{\mathrm{~d} x}+P(x) y=0\\
$$
**非齐次线性方程:**
$$
\frac{\mathrm{d} y}{\mathrm{~d} x}+P(x) y=Q(x)\\
$$


### 线性方程形式
就是 $y\,, y\prime \,, y^{\prime\prime}, y^{(n)}$ 之间是一次函数关系，其它关系的都称为非线性

##### 重难点： 关键在于理解线性变换
1. 输入一个向量 输出一个向量的特殊函数
2. `微分方程的求导算子 相当于对原方程做了 一次线性变换, 即求导过程相当于线性变换`
3. 微分算子：$D=\frac{d}{d x}$

指数函数是求导算子的特征函数
$\exp (x)=\exp (1)^x=e^x$

**线性变换具有的性质:**

在数学中，只要符合下面两个性质的就是线性变换 ( $T$ 代表变换 ,注意**齐次必须一次齐次**):
- 可加性: $T(\vec{x}+\vec{y})=T(\vec{x})+T(\vec{y})$
- 一次齐次性: $T(a \vec{x})=a T(\vec{x})$
比如，我们有两个多项式函数:
$$
f(x)=1+2 x+3 x^2 \quad g(x)=2+3 x+4 x^2\\
$$

那么容易验证， $D$ 是一个线性变换， 同时满足一次齐次性和可加性：
$$
\begin{align*}
    D(af(x)+ag(x))&=D(af(x))+D(ag(x))\\
    &=a D(f(x)) + a D(g(x)) \\
    & = a (5 +13x)\\
\end{align*}\\
$$

进一步的， $D$ 的多项式组合:
$$
\mathbf{L}=a_0+a_1 D+a_2 D^2+\cdots+a_n D^n, a_0, a_1, \cdots, a_n \in \mathbb{C}\\
$$

### 一阶线性微分方程的解

一阶线性微分方程：
$$
\frac{\mathrm{d} y}{\mathrm{~d} x}+P(x) y=Q(x)\\
$$

通过先求出对应非齐次线性方程的齐次线性方程$\frac{\mathrm{d} y}{\mathrm{~d} x}+P(x) y=0$的解。
* 分离变量：$\frac{\mathrm{d} y}{y}=-P(x) \mathrm{d} x$
* 两端积分： $\ln |y|=-\int P(x) \mathrm{d} x+C_1$或者表达：$y=C \mathrm{e}^{-\int p(x) d x} \quad\left(C=\pm \mathrm{e}^{C_1}\right)$

然后使用所谓常数变易法来求非齐次线性方程的通解. 这方法是把齐次方程通解中的 $C$ 换成 $x$ 的末知函数 $u(x)$, 即作变换：$y=u e^{-\int P(x) d x}$ 。
* 于是有：$\frac{\mathrm{d} y}{\mathrm{~d} x}=u^{\prime} \mathrm{e}^{-\int P(x) \mathrm{d} x}-u P(x) \mathrm{e}^{-\int P(x) \mathrm{d} x}$
* 将已知量带入原方程，得到：
$$
u^{\prime} \mathrm{e}^{-\int P(x) d x}=Q(x), u^{\prime}=Q(x) \mathrm{e}^{\int P(x) d x} \\
$$
* 两端积分，得：$u=\int Q(x) \mathrm{e}^{\int p(x) d x} \mathrm{~d} x+C$

综上线性方程的通解是：
$$
y=\mathrm{e}^{-\int P(x) d x}\left(\int Q(x) \mathrm{e}^{\int P(x) d x} \mathrm{~d} x+C\right)\\
$$
### 二阶常系数线性微分方程解
##### 齐次通解的结构

(1) 线性常系数齐次方程求解
1）二阶常系数齐次线性方程求解
二阶常系数齐次线性方程 $y^{\prime \prime}+p y^{\prime}+q y=0$ 的通解由下列表格给出:
$$
\begin{array}{l|l}
\hline \text { 特征方程 } r^2+p r+q=0 \text { 的两个根 } r_1, r_2 & \text { 微分方程 } y^{\prime \prime}+p y^{\prime}+q y=0 \text { 的通解 } \\
\hline \text { 两个不相等的实根 } r_1, r_2 & y=C_1 \mathrm{e}^{r_1 x}+C_2 \mathrm{e}^{r_1 x} \\
\hline \text { 两个相等的实根 } r_1=r_2 & y=\left(C_1+C_2 x\right) \mathrm{e}^{r_1 x} \\
\hline \text { 一对共轭复根 } r_{1.2}=\alpha \pm \mathrm{i} \beta & y=\mathrm{e}^{a r}\left(C_1 \cos \beta x+C_2 \sin \beta x\right) \\
\hline
\end{array}\\
$$

##### 非齐次特解结构
1) $f(x)=\mathrm{e}^{\lambda x} P_m(x)$ 型 ( $\lambda$ 为已知常数, $P_m(x)$ 为 $x$ 的 $m$ 次已知多项式) 其待定特解设为
$$
y^*=x^k \mathrm{e}^{\lambda x} Q_m(x)\\
$$
其中 $k$ 是特征方程根 $\lambda$ 的重数, $Q_m(x)$ 为系数待定的 $x$ 的 $m$ 次多项式.
* k 按照 （lamda ） 是否是特征方程的单根， 重根 或不是根， 依次取为 1， 2 ， 0

2) $f(x)=\mathrm{e}^{2 x}\left[P_l^{(1)}(x) \cos w x+P_n^{(2)}(x) \sin w x\right]$ 型 ( $\lambda$ 为已知常数, $P_t^{(1)}(x)$ 与 $P_n^{(2)}(x)$ 分别 为 $x$ 的 $l$ 次、 $x$ 的 $n$ 次的已知多项式）
其待定特解设为
$$
y^*=x^k \mathrm{e}^{\lambda x}\left[R_m^{(1)}(x) \cos w x+R_m^{(2)}(x) \sin w x\right]\\
$$
其中 $k$ 是特征方程根 $\lambda+\mathrm{i} w$ (或 $\lambda-\mathrm{i} w)$ 的重数, $R_m^{(1)}(x)$ 与 $R_m^{(2)}(x)$ 为系数待定的 $m$ 次多项式, $m=\max \{l, n\} .$
* K 按 （lamda + wi）是不是特征方程的根 取 0 或者 1

### 应用拓展
##### 偏导数全微分 与 微分方程结合
【例 18】设 $f(x)$ 有连续一阶导数, 且设 $(x y-y f(x)) \mathrm{d} x+\left(f(x)+y^2\right) \mathrm{d} y=\mathrm{d} u(x, y)$, 求 $f(x)$ 及 $u(x, y)$, 其中 $f(0)=-1$

**解题思路**： 利用以下结论建立微分方程, 先求出 $f(x)$, 然后再进一步求出 $u(x, y)$. 若 $P(x, y)$ 和 $Q(x, y)$ 有连续一阶偏导数, 且 $P(x, y) \mathrm{d} x+Q(x, y) \mathrm{d} y=\mathrm{d} u(x, y)$, 则由 $P=$ $\frac{\partial u}{\partial x}, Q=\frac{\partial u}{\partial y}, \frac{\partial P}{\partial y}=\frac{\partial^2 u}{\partial x \partial y}=\frac{\partial^2 u}{\partial y \partial x}=\frac{\partial Q}{\partial x}$, 可推出 $f(x)$ 应满足的微分方程.

反函数与 原函数的微分关系
【解】(1) $\frac{\mathrm{d} x}{\mathrm{~d} y}=\frac{1}{y}$
$$
\frac{\mathrm{d}^2 x}{\mathrm{~d} y^2}=\frac{\mathrm{d}}{\mathrm{d} x}\left(\frac{1}{y^{\prime}}\right) \frac{\mathrm{d} x}{\mathrm{~d} y}=-\frac{y^{\prime \prime}}{y^{\prime 2}} \frac{1}{y^{\prime}}=-\frac{y^{\prime \prime}}{y^{\prime 3}}\\
$$
将以上两式代人原方程得 $y^{\prime \prime}-y=\sin x$.
>Note： 
>* 线性方程大概是说微分方程的解做线性组合后还是原方程的解。而齐次方程是说： 构成这个方程的函数具有齐次性。
>* 对于n阶线性微分方程，齐次的考量不再是$g(x,y)$，而变成了$g(y)$;



##### 参考资料：
1. [【常微分方程】-浙江大学](https://www.bilibili.com/video/BV1y7411E7hp?p=2&spm_id_from=333.1007.top_right_bar_window_history.content.click&vd_source=1a163e481fb12c5b6ca8a57f994c1d73)
2. [线性微分方程与非线性微分方程的区别](https://www.zhihu.com/question/40919950)
3. [Homogeneous function](https://en.wikipedia.org/wiki/Homogeneous_function)